<!DOCTYPE html>
<html>
<head>
	<title>YouTyping test page</title>
	<script src="//cdnjs.cloudflare.com/ajax/libs/paper.js/0.9.12/paper-full.js"></script>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.js"></script>
	<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
	<script src="../youtyping.js"></script>
	<script src="../youtyping-screen.js"></script>
	<script src="jquery-deparam.js"></script>
	<script>
	var choices = [
	{
		videoId: 'fQ_m5VLhqNg',
		title: 'とまどい→レシピ'
	},
	{
		videoId: 'a_mWyahWoUA',
		title: '優しい忘却'
	},
	{
		videoId: 'dFf4AgBNR1E',
		title: '恋するフォーチュンクッキー'
	},
	{
		videoId: 'PqJNc9KVIZE',
		title: 'Tell your world',
		offset: 11,
		controlledCorrection: 40
	},
	{
		videoId: 'eGHDrlvypWg',
		title: 'さくらんぼ',
		offset: 9,
		controlledCorrection: -60
	},
	{
		id: 'eGHDrlvypWg-extract',
		videoId: 'eGHDrlvypWg',
		file: 'eGHDrlvypWg-extract',
		title: 'さくらんぼ (Extract)',
		offset: 9,
		controlledCorrection: -60
	},
	{
		id: 'eGHDrlvypWg-initial',
		videoId: 'eGHDrlvypWg',
		file: 'eGHDrlvypWg',
		title: 'さくらんぼ (Initial)',
		offset: 9,
		controlledCorrection: -60,
		initial: true
	}
	];

	// quick access
	var youTyping, screen;

	choices.forEach(function (choice) {
		choice.id = choice.id || choice.videoId;
		choice.file = choice.file || choice.videoId;
		choice.dataFile = choice.dataFile || (choice.file + '.utx');
		choice.offset = choice.offset || 0;
		choice.controlledCorrection = choice.controlledCorrection || 0;
	})

	$(document).ready(function () {
		var settings = $.deparam(location.search.slice(1));

		settings.id = settings.id || choices[0].id;

		// render choices
		choices.forEach(function (choice) {
			$('<a>', {
				href: './?' + $.param($.extend($.extend({}, settings), {id: choice.id})),
				text: choice.title
			})
			.addClass('btn')
			.addClass('btn-lg')
			.addClass(settings.id === choice.id ? 'btn-primary' : 'btn-default')
			.appendTo('#choices');
		});

		var choice = (function () {
			var result;
			choices.forEach(function (choice) {
				if (choice.id === settings.id) {
					result = choice;
				}
			});
			return result;
		})();
		settings.offset = choice.offset;
		settings.controlledCorrection = choice.controlledCorrection;
		settings.dataFile = choice.dataFile;
		settings.videoId = choice.videoId;
		settings.initial = settings.initial || choice.initial || false;
		settings.tableFile = '../convert/romaji.xml';
		screen = new Screen($('#youtyping'), settings);
		youTyping = screen.youTyping;
	});
	</script>
	<link rel="stylesheet" type="text/css" href="style.css">
	<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
	<h1>YouTyping Test Page</h1>
	<p>Sandbox mode is deprecated.</p>
	<div id="youtyping"></div>
	<div class="text-center">
		<div id="choices" style="display: inline-block;"></div>
	</div>
	<p>Setting can be overrided by URI query e.g. <a href="./?speed=1.0&amp;noteSize=30">./?speed=1.0&amp;noteSize=30</a></p>
	<p>Powered by <a href="https://www.youtube.com/">YouTube</a></p>
	<textarea id="debug"></textarea>
</body>
</html>
