<!DOCTYPE html>
<html>
<head>
	<title>YouTyping test page</title>
	<script src="//cdnjs.cloudflare.com/ajax/libs/paper.js/0.9.12/paper-full.js"></script>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.js"></script>
	<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
	<script src="../youtyping.js"></script>
	<script src="jquery-deparam.js"></script>
	<script>
		var choices = [
		{
			videoId: 'fQ_m5VLhqNg',
			title: 'とまどい→レシピ'
		},
		{
			videoId: 'a_mWyahWoUA',
			title: '優しい忘却'
		},
		{
			videoId: 'dFf4AgBNR1E',
			title: '恋するフォーチュンクッキー'
		},
		{
			videoId: 'PqJNc9KVIZE',
			title: 'Tell your world',
			offset: 11,
			controlledCorrection: 40
		},
		{
			videoId: 'eGHDrlvypWg',
			title: 'さくらんぼ',
			offset: 9,
			controlledCorrection: -60
		},
		{
			videoId: 'eGHDrlvypWg',
			file: 'eGHDrlvypWg-extract',
			title: 'さくらんぼ (Extract)',
			offset: 9,
			controlledCorrection: -60
		}
		];

		choices.forEach(function (choice) {
			choice.file = choice.file || choice.videoId;
			choice.dataFile = choice.dataFile || (choice.file + '.utx');
			choice.offset = choice.offset || 0;
			choice.controlledCorrection = choice.controlledCorrection || 0;
		})

		$(document).ready(function () {
			var settings = $.deparam(location.search.slice(1));

			if (!settings.file) {
				settings.file = choices[0].videoId;
			}

			settings.dataFile = settings.file + '.utx';

			// render choices
			choices.forEach(function (choice) {
				$('<a>', {
					href: './?file=' + choice.file,
					text: choice.title
				})
				.addClass('btn')
				.addClass('btn-lg')
				.addClass(settings.file === choice.file ? 'btn-primary' : 'btn-default')
				.appendTo('#choices');
			});

			var choice = (function () {
				var result;
				choices.forEach(function (choice) {
					console.log(choice.dataFile, settings.dataFile);
					if (choice.dataFile === settings.dataFile) {
						result = choice;
					}
				});
				return result;
			})();

			settings.offset = choice.offset;
			settings.controlledCorrection = choice.controlledCorrection;
			settings.videoId = choice.videoId;
			settings.tableFile = '../convert/romaji.xml';
			youTyping = new YouTyping($('#youtyping'), settings);
		});
	</script>
	<link rel="stylesheet" type="text/css" href="style.css">
	<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
	<h1>YouTyping Test Page</h1>
	<p>Sandbox mode is deprecated.</p>
	<div id="youtyping"></div>
	<div class="text-center">
		<div id="choices" style="display: inline-block;"></div>
	</div>
	<p>Setting can be overrided by URI query e.g. <a href="./?speed=1.0&amp;noteSize=30">./?speed=1.0&amp;noteSize=30</a></p>
	<p>Powered by <a href="https://www.youtube.com/">YouTube</a></p>
	<textarea id="debug"></textarea>
</body>
</html>
